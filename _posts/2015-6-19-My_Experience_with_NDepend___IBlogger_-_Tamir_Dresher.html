---
layout: msblogpost
title: "My Experience with NDepend "
date: 2015-6-19
msblogurl: "http://blogs.microsoft.co.il/iblogger/2015/06/19/my-experience-with-ndepend/"
---
<DIV class="contx entry-content clearfix"><P>Disclosure: I received a free license to NDepend </P>
<P>I know about NDepend (<A href="http://www.ndepend.com/">www.ndepend.com</A>) for a very long time, I believe that I heard about it and read about it from the day it got its name. even though I knew it, I never spent the time to really use it and I never really understood why should I use it. </P>
<P>this all changed in the last few months. you see, I got a free license and that was the trigger to a very good friendship between NDepend and me. </P>
<P>NDepend is a tool that allows you to investigate your code base. it holds a list of rules that you can run against your code and get different metrics to help you diagnose areas where there might be a problem and an indication about the quality of your code. </P>
<P>You can run NDepend as part of visual studio or a standalone application. </P>
<P>This is how it looks after I ran NDepend against one of my projects with the standalone application </P>
<P><A href="{{ site.url }}/assets/My Experience with NDepend _ IBlogger - Tamir Dresher_files/image.png"><IMG title=image style="BORDER-LEFT-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; BORDER-TOP-WIDTH: 0px" border=0 alt=image src="{{ site.url }}/assets/My Experience with NDepend _ IBlogger - Tamir Dresher_files/image_thumb.png" width=708 height=377></A> </P>
<P><B>What is it good for?</B> </P>
<P>There are a few use cases that I found NDepend to be very very good for. you see, as a consultant I usually have more than one project that I’m working on, and sometimes there might be a long time that I can’t attend a project because I’m traveling or lecturing. </P>
<P>to maintain control over the quality of the project and to make sure that the guidelines that we set are being kept inside the team, NDepend really comes in handy. </P>
<P>NDepend holds a really full and long list of queries and rules that it tests your code against. </P>
<P><A href="{{ site.url }}/assets/My Experience with NDepend _ IBlogger - Tamir Dresher_files/image1.png"><IMG title=image style="BORDER-LEFT-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; BORDER-TOP-WIDTH: 0px" border=0 alt=image src="{{ site.url }}/assets/My Experience with NDepend _ IBlogger - Tamir Dresher_files/image_thumb1.png" width=594 height=245></A> </P>
<P>After you run the NDepend analysis on your code you get values for each one of the rules. </P>
<P>for example, in the picture above you can see that NDepend found that I have two methods that are two complex </P>
<P><A href="{{ site.url }}/assets/My Experience with NDepend _ IBlogger - Tamir Dresher_files/clip_image0061.png"><IMG title=clip_image006 style="BORDER-LEFT-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; BORDER-TOP-WIDTH: 0px" border=0 alt=clip_image006 src="{{ site.url }}/assets/My Experience with NDepend _ IBlogger - Tamir Dresher_files/clip_image006_thumb1.png" width=434 height=151></A> </P>
<P>if we click on the rule, we can drill down and see what are those methods and what was the exact score they got </P>
<P><A href="{{ site.url }}/assets/My Experience with NDepend _ IBlogger - Tamir Dresher_files/clip_image0081.png"><IMG title=clip_image008 style="BORDER-LEFT-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; BORDER-TOP-WIDTH: 0px" border=0 alt=clip_image008 src="{{ site.url }}/assets/My Experience with NDepend _ IBlogger - Tamir Dresher_files/clip_image008_thumb1.png" width=415 height=285></A> </P>
<P>But what is the score means? one of the greatest things of NDepend is that although it is so comprehensive, it gives great documentation for every rule or feature. when I click on the rule I can see the full query it makes together with explanation and link to a very detailed page that describe everything about it </P>
<P><A href="{{ site.url }}/assets/My Experience with NDepend _ IBlogger - Tamir Dresher_files/clip_image0101.png"><IMG title=clip_image010 style="BORDER-LEFT-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; BORDER-TOP-WIDTH: 0px" border=0 alt=clip_image010 src="{{ site.url }}/assets/My Experience with NDepend _ IBlogger - Tamir Dresher_files/clip_image010_thumb1.png" width=421 height=195></A> </P>
<P><B>Extensibility</B> </P>
<P>The NDepend queries are written in a language called <A href="http://www.ndepend.com/docs/cqlinq-syntax">CQLinq</A> (Code Query Language). CQLinq is a LINQ-based language that allows you to make queries on the types, assemblies, methods and everything in the code object model of your project. </P>
<P>With CQLinq you can create new queries to add to the NDepend project so that you can keep test your code with rules that are relevant to your domain. </P>
<P>here is a simple CQLinq query that checks that all the methods inside some namespace has low <A href="https://en.wikipedia.org/wiki/Cyclomatic_complexity">Cyclomatic Complexity</A></P><PRE><FONT color=#0000ff><FONT style="FONT-SIZE: 7.5pt">from</FONT></FONT><FONT style="FONT-SIZE: 7.5pt"><FONT color=#000000>&nbsp;</FONT><FONT color=#000000>m</FONT><FONT color=#000000>&nbsp;</FONT><FONT color=#0000ff>in</FONT><FONT color=#000000>&nbsp;</FONT><B style="COLOR: "><FONT style="BACKGROUND-COLOR: #e8e8ff" color=#000064>Application</FONT></B><FONT color=#000000>.</FONT><FONT color=#000000>Namespaces</FONT><FONT color=#000000>.</FONT><FONT color=#000000>WithNameLike</FONT><FONT color=#000000>(</FONT><FONT color=#a31515>"ProductName.FeatureA"</FONT><FONT color=#000000>)</FONT><FONT color=#000000>.</FONT><FONT color=#000000>ChildMethods</FONT><FONT color=#000000>(</FONT><FONT color=#000000>)</FONT><FONT color=#000000><BR></FONT><FONT color=#0000ff>where</FONT><FONT color=#000000>&nbsp;</FONT><FONT color=#000000>m</FONT><FONT color=#000000>.</FONT><FONT color=#000000>CyclomaticComplexity</FONT><FONT color=#000000>&nbsp;</FONT><FONT color=#000000>&gt;</FONT><FONT color=#000000>&nbsp;<B style="COLOR: "><FONT style="BACKGROUND-COLOR: #ffff99">10</FONT></B>&nbsp;</FONT><FONT color=#0000ff>select</FONT><FONT color=#000000>&nbsp;</FONT></FONT><FONT color=#000000><FONT style="FONT-SIZE: 7.5pt">m</FONT></FONT></PRE>
<P><B>Maintiaing Control</B></P>
<P>When you create a NDepend project and run analysis on your code, NDepend will remember the results you got, so next time you run the analysis you can see if improved or not.</P>
<P>on the NDepend dashboard there are various graphs that let you see how your project is look as the time goes</P>
<P><A href="{{ site.url }}/assets/My Experience with NDepend _ IBlogger - Tamir Dresher_files/clip_image0121.jpg"><IMG title=clip_image012 style="BORDER-LEFT-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; BORDER-TOP-WIDTH: 0px" border=0 alt=clip_image012 src="{{ site.url }}/assets/My Experience with NDepend _ IBlogger - Tamir Dresher_files/clip_image012_thumb1.jpg" width=712 height=459></A></P>
<P><B>Conclusion </B></P>
<P>I Really like NDepend and there are many more features I haven’t mentioned here such as the ability to attach it to you CI and generate reports or visualizing your project with wonderful charts and graphs.</P>
<P>I recommend you to try it yourself and see what new insights you can discover on your project.</P>
<P>NDepend is a great addition to your tool belt and will be invaluable tool when you starting to work on a new project or learning an existing one.</P><IFRAME style="BORDER-TOP-STYLE: none; OVERFLOW: hidden; BORDER-LEFT-STYLE: none; HEIGHT: 80px; BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none" src="{{ site.url }}/assets/My Experience with NDepend _ IBlogger - Tamir Dresher_files/like.html" frameBorder=0 allowTransparency scrolling=no></IFRAME></DIV>
